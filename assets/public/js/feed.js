(()=>{var e={338:function(e){e.exports=function(){"use strict";return function(e){var t=document,n=e.container||t.createElement("div");n.id=n.id||"autocomplete-"+h();var r,o,a=n.style,i=navigator.userAgent,u=~i.indexOf("Firefox")&&~i.indexOf("Mobile"),l=e.debounceWaitMs||0,c=e.preventSubmit||!1,s=e.disableAutoSelect||!1,f=u?"input":"keyup",d=[],p="",v=2,m=e.showOnFocus,b=0;if(void 0!==e.minLength&&(v=e.minLength),!e.input)throw new Error("input undefined");var y=e.input;function h(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}function g(){o&&window.clearTimeout(o)}function w(){return!!n.parentNode}function j(){var e;b++,d=[],p="",r=void 0,y.setAttribute("aria-activedescendant",""),y.setAttribute("aria-expanded","false"),(e=n.parentNode)&&e.removeChild(n)}function k(){for(;n.firstChild;)n.removeChild(n.firstChild);y.setAttribute("aria-activedescendant","");var o=function(e,n,r){var o=t.createElement("div");return o.textContent=e.label||"",o};e.render&&(o=e.render);var i=function(e,n){var r=t.createElement("div");return r.textContent=e,r};e.renderGroup&&(i=e.renderGroup);var u=t.createDocumentFragment(),l="#9?$";if(d.forEach((function(t,a){if(t.group&&t.group!==l){l=t.group;var c=i(t.group,p);c&&(c.className+=" group",u.appendChild(c))}var s=o(t,p,a);s&&(s.id=n.id+"_"+a,s.setAttribute("role","option"),s.addEventListener("click",(function(n){e.onSelect(t,y),j(),n.preventDefault(),n.stopPropagation()})),t===r&&(s.className+=" selected",s.setAttribute("aria-selected","true"),y.setAttribute("aria-activedescendant",s.id)),u.appendChild(s))})),n.appendChild(u),d.length<1){if(!e.emptyMsg)return void j();var c=t.createElement("div");c.id=n.id+"_"+h(),c.className="empty",c.textContent=e.emptyMsg,n.appendChild(c),y.setAttribute("aria-activedescendant",c.id)}n.parentNode||t.body.appendChild(n),function(){if(w()){y.setAttribute("aria-expanded","true"),a.height="auto",a.width=y.offsetWidth+"px";var r,o=0;i(),i(),e.customize&&r&&e.customize(y,r,n,o)}function i(){var e=t.documentElement,n=e.clientTop||t.body.clientTop||0,i=e.clientLeft||t.body.clientLeft||0,u=window.pageYOffset||e.scrollTop,l=window.pageXOffset||e.scrollLeft,c=(r=y.getBoundingClientRect()).top+y.offsetHeight+u-n,s=r.left+l-i;a.top=c+"px",a.left=s+"px",(o=window.innerHeight-(r.top+y.offsetHeight))<0&&(o=0),a.top=c+"px",a.bottom="",a.left=s+"px",a.maxHeight=o+"px"}}(),function(){var e=n.getElementsByClassName("selected");if(e.length>0){var t=e[0],r=t.previousElementSibling;if(r&&-1!==r.className.indexOf("group")&&!r.previousElementSibling&&(t=r),t.offsetTop<n.scrollTop)n.scrollTop=t.offsetTop;else{var o=t.offsetTop+t.offsetHeight,a=n.scrollTop+n.offsetHeight;o>a&&(n.scrollTop+=o-a)}}}()}function _(){w()&&k()}function A(){_()}function x(e){e.target!==n?_():e.preventDefault()}function S(t){for(var n=t.which||t.keyCode||0,r=0,o=e.keysToIgnore||[38,13,27,39,37,16,17,18,20,91,9];r<o.length;r++)if(n===o[r])return;n>=112&&n<=123&&!e.keysToIgnore||40===n&&w()||L(0)}function E(t){var n=t.which||t.keyCode||0;if(38===n||40===n||27===n){var o=w();if(27===n)j();else{if(!o||d.length<1)return;38===n?function(){if(d.length<1)r=void 0;else if(r===d[0])r=d[d.length-1];else for(var e=d.length-1;e>0;e--)if(r===d[e]||1===e){r=d[e-1];break}}():function(){if(d.length<1&&(r=void 0),r&&r!==d[d.length-1]){for(var e=0;e<d.length-1;e++)if(r===d[e]){r=d[e+1];break}}else r=d[0]}(),k()}return t.preventDefault(),void(o&&t.stopPropagation())}13===n&&(r&&(e.onSelect(r,y),j()),c&&t.preventDefault())}function C(){m&&L(1)}function L(t){var n=++b,a=y.value,i=y.selectionStart||0;a.length>=v||1===t?(g(),o=window.setTimeout((function(){e.fetch(a,(function(e){b===n&&e&&(p=a,r=(d=e).length<1||s?void 0:d[0],k())}),t,i)}),0===t?l:0)):j()}function D(){setTimeout((function(){t.activeElement!==y&&j()}),200)}return n.className="autocomplete "+(e.className||""),n.setAttribute("role","listbox"),y.setAttribute("role","combobox"),y.setAttribute("aria-expanded","false"),y.setAttribute("aria-autocomplete","list"),y.setAttribute("aria-controls",n.id),y.setAttribute("aria-owns",n.id),y.setAttribute("aria-activedescendant",""),y.setAttribute("aria-haspopup","listbox"),a.position="absolute",n.addEventListener("mousedown",(function(e){e.stopPropagation(),e.preventDefault()})),n.addEventListener("focus",(function(){return y.focus()})),y.addEventListener("keydown",E),y.addEventListener(f,S),y.addEventListener("blur",D),y.addEventListener("focus",C),window.addEventListener("resize",A),t.addEventListener("scroll",x,!0),{destroy:function(){y.removeEventListener("focus",C),y.removeEventListener("keydown",E),y.removeEventListener(f,S),y.removeEventListener("blur",D),window.removeEventListener("resize",A),t.removeEventListener("scroll",x,!0),y.removeAttribute("role"),y.removeAttribute("aria-expanded"),y.removeAttribute("aria-autocomplete"),y.removeAttribute("aria-controls"),y.removeAttribute("aria-activedescendant"),y.removeAttribute("aria-owns"),y.removeAttribute("aria-haspopup"),g(),j()}}}}()}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,n),a.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";var e=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};fetch(e,{method:"POST",body:t}).then((function(e){return e.text()})).then((function(e){return n(e)})).catch((function(e){return n(e)}))};function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var r=function(e,n){var r,o,a=n&&0!==Object.keys(n).length,i=a?document.createElement("select"):document.querySelector("#prisjakt_feed_filters tr.hidden-rows .prisjakt-filter-value").cloneNode(!0),u=e.parentNode.parentNode.parentNode.querySelector(".prisjakt-filter-value"),l=u.getAttribute("class"),c=u.getAttribute("name"),s=u.value;if(i.setAttribute("class",l),i.setAttribute("name",c),i.setAttribute("value",s),a)for(var f=0,d=Object.entries(n);f<d.length;f++){var p=(r=d[f],o=2,function(e){if(Array.isArray(e))return e}(r)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,a,i,u=[],l=!0,c=!1;try{if(a=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=a.call(n)).done)&&(u.push(r.value),u.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw o}}return u}}(r,o)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(r,o)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),v=p[0],m=p[1],b=document.createElement("option");u.value===v&&b.setAttribute("selected","selected"),b.value=v,b.innerHTML=m,i.appendChild(b)}u.replaceWith(i)},o=function(e){var t=e.target.value,n=prisjakt_ajax_object.feed_filters[t];r(e.target,n)},a=function(){document.querySelectorAll("#prisjakt_feed_filters tr:not(.hidden-rows) .prisjakt-filter-select").forEach((function(e){e.removeEventListener("change",o,!0),e.addEventListener("change",o,!0)}))},i=function(){var e=[],t=document.querySelectorAll("#prisjakt_feed_field_mapping table tr:not(.hidden-rows) td:first-child select");t.forEach((function(t){var n=t.value;n&&e.push(n)})),t.forEach((function(t){var n=t.value;Object.values(t.options).forEach((function(t){t.removeAttribute("hidden"),e.includes(t.value)&&t.value!==n&&t.setAttribute("hidden","hidden")}))}))},u=function(){document.querySelectorAll("#prisjakt_feed_field_mapping tr:not(.hidden-rows) td:first-child select").forEach((function(e){e.removeEventListener("change",i,!0),e.addEventListener("change",i,!0)})),i()};function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"),"symbol"===l(o)?o:String(o)),r)}var o}new(function(){function t(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var e=prisjakt_ajax_object,n=e.form_id,r=e.steps,o=e.step;this.ajaxFormData=new FormData,this.actions=["continue","save_continue","back","generate","add_field_mapping","add_custom_field","add_filter"],this.rowActions=["delete_row"],this.validates=["field_mapping_text_validate"],this.form=document.querySelector("#".concat(n)),r&&this.setStep(o),this.setupActions(),this.setupRowActions()}var n,r;return n=t,r=[{key:"getCamelizeActionCallbackName",value:function(e){var t=this.camelize(e.replaceAll("_"," "));return"".concat(this.camelize(t),"Callback")}},{key:"setupActions",value:function(){var e=this;this.actions.forEach((function(t){var n=document.querySelectorAll('input[data-action="'+t+'"]');n&&n.forEach((function(n){n.addEventListener("click",(function(n){e.ajaxFormData=new FormData,n.preventDefault();var r=e.getCamelizeActionCallbackName(t),o=n.target,a={target:o,ajaxAction:o.getAttribute("data-ajax-action"),prefix:o.getAttribute("data-prefix"),action:o.getAttribute("data-action"),step:o.getAttribute("data-step"),event:n};e[r](a)}))}))}))}},{key:"setupRowActions",value:function(){var e=this;this.rowActions.forEach((function(t){var n=document.querySelectorAll('span[data-action="'+t+'"]');n&&n.forEach((function(n){var r=e[e.getCamelizeActionCallbackName(t)];n.removeEventListener("click",r,!0),n.addEventListener("click",r,!0)}))})),this.validates.forEach((function(t){var n=document.querySelectorAll("."+t);n&&n.forEach((function(n){var r=e[e.getCamelizeActionCallbackName(t)];n.removeEventListener("change",r,!0),n.addEventListener("change",r,!0)}))}))}},{key:"camelize",value:function(e){return e.replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,"")}},{key:"isHidden",value:function(e){return null===e.offsetParent}},{key:"setStep",value:function(e){var t=this,n="show-step",r=prisjakt_ajax_object,o=r.steps,a=r.prefix;o.forEach((function(r){var o=document.querySelector("#"+a+r);e===r?(o.classList.add(n),t.ajaxFormData.append("feed_step",r)):o.classList.remove(n)}))}},{key:"validateElements",value:function(e){var t=this,n=!0,r=e.target.closest(".postbox").querySelector("table").querySelectorAll('input:not([type="button"]), select'),o=prisjakt_ajax_object.validation_messages;return r.forEach((function(e){if(e.required&&!t.isHidden(e)){var r=e.getAttribute("max"),a=e.getAttribute("min"),i=e.value.length,u=!e.value;switch(e.setCustomValidity(""),e.type){case"text":if(u){e.setCustomValidity(o.text_value_missing);break}i>Number(r)&&e.setCustomValidity(o.max_text_length+" "+r+"."),i<Number(a)&&e.setCustomValidity(o.min_text_length+" "+a+".");break;case"select-one":u&&e.setCustomValidity(o.select_value_missing)}e.checkValidity()||(e.reportValidity(),n&&(n=!1))}})),n}},{key:"saveData",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=t.ajaxAction,o=prisjakt_ajax_object,a=o.ajax_nonce,i=o.post_id,u=o.ajax_url,l={form_elements:new URLSearchParams(new FormData(this.form)).toString()};this.ajaxFormData.append("action",r),this.ajaxFormData.append("security",a),this.ajaxFormData.append("post_id",i),this.ajaxFormData.append("data",JSON.stringify(l)),e(u,this.ajaxFormData,n)}},{key:"fieldMappingTextValidateCallback",value:function(e){var t=e.target;t.value=t.value.replace(/\s+/g,"_").toLowerCase()}},{key:"deleteRowCallback",value:function(e){e.target.closest("tr").remove(),u()}},{key:"prepareDefaultRow",value:function(e){var t,n,r=e.cloneNode(!0);return(t=r.classList).remove.apply(t,function(e){if(Array.isArray(e))return c(e)}(n=r.classList)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(n)||function(e,t){if(e){if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?c(e,t):void 0}}(n)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r}},{key:"continueCallback",value:function(e){var t=e.step,n=e.event,r=prisjakt_ajax_object.steps;this.validateElements(n)&&r&&this.setStep(t),this.saveData(e)}},{key:"insertRow",value:function(e){var t=e.target,n=t.getAttribute("data-row-action"),r=t.closest("tbody"),o=r.querySelector(".action-index-".concat(n)),a=r.querySelectorAll("tr.hidden-rows")[0],i=this.prepareDefaultRow(o);a.parentNode.insertBefore(i,a),this.setupRowActions()}},{key:"addFieldMappingCallback",value:function(e){this.insertRow(e),u()}},{key:"addCustomFieldCallback",value:function(e){this.insertRow(e)}},{key:"addFilterCallback",value:function(e){this.insertRow(e),a()}},{key:"saveContinueCallback",value:function(e){this.continueCallback(e)}},{key:"backCallback",value:function(e){var t=prisjakt_ajax_object.steps,n=e.step,r=e.event;this.validateElements(r)&&t&&this.setStep(n),this.saveData(e)}},{key:"generateCallback",value:function(e){var t=prisjakt_ajax_object.steps;this.ajaxFormData.append("feed_step",t[0]),this.ajaxFormData.append("is_active",!0),this.saveData(e,(function(e){var t=prisjakt_ajax_object.form_id;document.querySelector("#".concat(t)).submit()}))}}],r&&s(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),t}());var f=n(338),d=n.n(f);function p(e){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p(e)}function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==p(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==p(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"),"symbol"===p(o)?o:String(o)),r)}var o}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(void 0,o=function(e,t){if("object"!==m(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!==m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(r.key,"string"),"symbol"===m(o)?o:String(o)),r)}var o}new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setupInputs()}var t,n;return t=e,(n=[{key:"setupInputs",value:function(){var e=this;document.querySelectorAll(".category_input_autocomplete").forEach((function(t){return e.setupInputAutocomplete(t)}))}},{key:"setupInputAutocomplete",value:function(e){d()({input:e,fetch:function(e,t){e=e.toLowerCase();var n=Number.isInteger(Number(e));console.log(prisjakt_ajax_object.category_mapping),t(prisjakt_ajax_object.category_mapping.filter((function(t){return n?t.label.toLowerCase().startsWith(e):t.label.toLowerCase().includes(e)})))},onSelect:function(t){e.value=t.label.split(" - ")[1]},render:function(e){var t=document.createElement("div");return t.textContent=e.label,t},debounceWaitMs:400,preventSubmit:!0})}}])&&v(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}()),new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.form=document.querySelector("form#".concat(prisjakt_ajax_object.form_id)),this.steps=prisjakt_ajax_object.steps,this.disableFeedExitPrompt(),a(),document.querySelectorAll("#prisjakt_feed_filters tr:not(.hidden-rows) .prisjakt-filter-select").forEach((function(e){var t=e.value,n=prisjakt_ajax_object.feed_filters[t];r(e,n)})),u()}var t,n;return t=e,(n=[{key:"disableFeedExitPrompt",value:function(){jQuery(window).unbind("beforeunload"),window.autosave=function(){return!1},void 0!==window.wp.autosave&&(window.wp.autosave.server.postChanged=function(){})}}])&&b(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}())})()})();